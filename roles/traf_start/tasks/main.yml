- name: create sqconfig for trafodion instance
  script:  traf_sqconfig {{ansible_processor_vcpus - 1}} {{ansible_processor_count}} {{ sq_root + '/sql/scripts/sqconfig' }} {{ node_list }}
  become: yes
  become_user: trafodion

- name: run sqgen for trafodion instance
  shell: 'source /home/trafodion/.bashrc; sqgen'
  become: yes
  become_user: trafodion

- name: start trafodion instance
  shell: 'source /home/trafodion/.bashrc; sqstart'
  become: yes
  become_user: trafodion
  when: traf_start=='Y'

- name: initialize trafodion
  shell: 'source /home/trafodion/.bashrc; echo \"initialize trafodion;\" | sqlci'
  become: yes
  become_user: trafodion
  when: traf_init=='Y'

- name: initialize trafodion
  shell: 'source /home/trafodion/.bashrc; echo \"initialize trafodion, upgrade;\" | sqlci'
  become: yes
  become_user: trafodion
  when: traf_init=='N'
